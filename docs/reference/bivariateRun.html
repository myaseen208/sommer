<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>bivariateRun functionality — bivariateRun • sommer</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="bivariateRun functionality — bivariateRun"><meta name="description" content="Sometimes multi-trait models can present many singularities making the model hard to estimate with many traits. One of the most effective strategies is to estimate all possible variance and covariances splitting in multiple bivariate models. This function takes a model that has t traits and splits the model in as many bivariate models as needed to estimate all the variance and covariances to provide the initial values for the model with all traits."><meta property="og:description" content="Sometimes multi-trait models can present many singularities making the model hard to estimate with many traits. One of the most effective strategies is to estimate all possible variance and covariances splitting in multiple bivariate models. This function takes a model that has t traits and splits the model in as many bivariate models as needed to estimate all the variance and covariances to provide the initial values for the model with all traits."><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-116716530-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-116716530-2');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sommer</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">4.3.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-code"></span> Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-file-o"></span> Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/v1.sommer.quick.start.html">Quick Start</a></li>
    <li><a class="dropdown-item" href="../articles/v2.sommer.changes.and.faqs.html">FAQ</a></li>
    <li><a class="dropdown-item" href="../articles/v3.sommer.qg.html">Quantitative Genetics</a></li>
    <li><a class="dropdown-item" href="../articles/v4.sommer.gxe.html">GxE models</a></li>
    <li><a class="dropdown-item" href="../articles/v5.sommer.vs.lme4.html">sommer vs lme4</a></li>
    <li><a class="dropdown-item" href="../articles/v6.sommer.spatial.html">Spatial</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="https://github.com/covaruber/sommer" aria-label="GitHub repository"><span class="fa fa-github"></span> GitHub</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>bivariateRun functionality</h1>

      <div class="d-none name"><code>bivariateRun.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Sometimes multi-trait models can present many singularities making the model hard to estimate with many traits. One of the most effective strategies is to estimate all possible variance and covariances splitting in multiple bivariate models. This function takes a model that has t traits and splits the model in as many bivariate models as needed to estimate all the variance and covariances to provide the initial values for the model with all traits.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bivariateRun</span><span class="op">(</span><span class="va">model</span>, <span class="va">n.core</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>a model fitted with the mmer function with argument return.param=TRUE.</p></dd>

  <dt id="arg-n-core">n.core<a class="anchor" aria-label="anchor" href="#arg-n-core"></a></dt>
<dd><p>number of cores to use in the mclapply function to parallelize the models to be run to avoid increase in computational time. Please keep in mind that this is only available in Linux and macOS systems. Please check the details in the <code>mclapply</code> documentation of the parallel package.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p></p><dl><dt>$sigmas</dt>
<dd><p>the list with the variance covariance parameters for all traits together.</p></dd>

    <dt>$sigmascor</dt>
<dd><p>the list with the correlation for the variance components for all traits together.</p></dd>

    <dt>$model</dt>
<dd><p>the results from the bivariate models.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Covarrubias-Pazaran G (2016) Genome assisted prediction of quantitative traits using the R package sommer. PLoS ONE 11(6): doi:10.1371/journal.pone.0156744</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Giovanny Covarrubias-Pazaran</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>The core function of the package <code><a href="mmer.html">mmer</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ####=========================================####</span></span></span>
<span class="r-in"><span><span class="co"># ####=========================================####</span></span></span>
<span class="r-in"><span><span class="co"># #### EXAMPLE 1</span></span></span>
<span class="r-in"><span><span class="co"># #### simple example with univariate models</span></span></span>
<span class="r-in"><span><span class="co"># ####=========================================####</span></span></span>
<span class="r-in"><span><span class="co"># ####=========================================####</span></span></span>
<span class="r-in"><span><span class="co"># data("DT_cpdata")</span></span></span>
<span class="r-in"><span><span class="co"># DT &lt;- DT_cpdata</span></span></span>
<span class="r-in"><span><span class="co"># GT &lt;- GT_cpdata</span></span></span>
<span class="r-in"><span><span class="co"># MP &lt;- MP_cpdata</span></span></span>
<span class="r-in"><span><span class="co"># #### create the variance-covariance matrix</span></span></span>
<span class="r-in"><span><span class="co"># A &lt;- A.mat(GT)</span></span></span>
<span class="r-in"><span><span class="co"># #### look at the data and fit the model</span></span></span>
<span class="r-in"><span><span class="co"># head(DT)</span></span></span>
<span class="r-in"><span><span class="co"># ans.m &lt;- mmer(cbind(Yield,color,FruitAver, Firmness)~1,</span></span></span>
<span class="r-in"><span><span class="co">#                random=~ vsr(id, Gu=A, Gtc=unsm(4))</span></span></span>
<span class="r-in"><span><span class="co">#                + vsr(Rowf,Gtc=diag(4))</span></span></span>
<span class="r-in"><span><span class="co">#                + vsr(Colf,Gtc=diag(4)), na.method.Y="include",</span></span></span>
<span class="r-in"><span><span class="co">#                rcov=~ vsr(units,Gtc=unsm(4)), return.param = TRUE,</span></span></span>
<span class="r-in"><span><span class="co">#                data=DT)</span></span></span>
<span class="r-in"><span><span class="co"># </span></span></span>
<span class="r-in"><span><span class="co"># # define the number of cores (number of bivariate models) as (nt*(nt-1))/2 </span></span></span>
<span class="r-in"><span><span class="co"># nt=4</span></span></span>
<span class="r-in"><span><span class="co"># (nt*(nt-1))/2</span></span></span>
<span class="r-in"><span><span class="co"># res &lt;- bivariateRun(ans.m,n.core = 6)</span></span></span>
<span class="r-in"><span><span class="co"># # now use the variance componets to fit a join model</span></span></span>
<span class="r-in"><span><span class="co"># mm &lt;- transformConstraints(ans.m[[8]],3)</span></span></span>
<span class="r-in"><span><span class="co"># </span></span></span>
<span class="r-in"><span><span class="co"># ans.m.final &lt;- mmer(cbind(Yield,color,FruitAver, Firmness)~1,</span></span></span>
<span class="r-in"><span><span class="co">#               random=~ vsr(id, Gu=A, Gtc=unsm(4))</span></span></span>
<span class="r-in"><span><span class="co">#               + vsr(Rowf,Gtc=diag(4))</span></span></span>
<span class="r-in"><span><span class="co">#               + vsr(Colf,Gtc=diag(4)), na.method.Y="include",</span></span></span>
<span class="r-in"><span><span class="co">#               rcov=~ vsr(units,Gtc=unsm(4)), </span></span></span>
<span class="r-in"><span><span class="co">#               init = res$sigmas_scaled, constraints = mm,</span></span></span>
<span class="r-in"><span><span class="co">#               data=DT, iters=1)</span></span></span>
<span class="r-in"><span><span class="co"># </span></span></span>
<span class="r-in"><span><span class="co"># summary(ans.m.final)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/covaruber" class="external-link">Giovanny Covarrubias-Pazaran</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

