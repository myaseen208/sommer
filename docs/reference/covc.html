<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>covariance between random effects — covc • sommer</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="covariance between random effects — covc"><meta name="description" content="covc merges the incidence matrices and covariance matrices of two random effects to fit an unstructured model between 2 different random effects to be fitted with the mmec solver."><meta property="og:description" content="covc merges the incidence matrices and covariance matrices of two random effects to fit an unstructured model between 2 different random effects to be fitted with the mmec solver."><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-116716530-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-116716530-2');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sommer</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">4.3.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-code"></span> Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-file-o"></span> Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/v1.sommer.quick.start.html">Quick Start</a></li>
    <li><a class="dropdown-item" href="../articles/v2.sommer.changes.and.faqs.html">FAQ</a></li>
    <li><a class="dropdown-item" href="../articles/v3.sommer.qg.html">Quantitative Genetics</a></li>
    <li><a class="dropdown-item" href="../articles/v4.sommer.gxe.html">GxE models</a></li>
    <li><a class="dropdown-item" href="../articles/v5.sommer.vs.lme4.html">sommer vs lme4</a></li>
    <li><a class="dropdown-item" href="../articles/v6.sommer.spatial.html">Spatial</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="https://github.com/covaruber/sommer" aria-label="GitHub repository"><span class="fa fa-github"></span> GitHub</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>covariance between random effects</h1>

      <div class="d-none name"><code>covc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>covc</code> merges the incidence matrices and covariance matrices of two random effects to fit an unstructured model between 2 different random effects to be fitted with the <code><a href="mmec.html">mmec</a></code> solver.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">covc</span><span class="op">(</span><span class="va">ran1</span>, <span class="va">ran2</span>, thetaC<span class="op">=</span><span class="cn">NULL</span>, theta<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-ran-">ran1<a class="anchor" aria-label="anchor" href="#arg-ran-"></a></dt>
<dd><p>the random call of the first random effect.</p></dd>

  <dt id="arg-ran-">ran2<a class="anchor" aria-label="anchor" href="#arg-ran-"></a></dt>
<dd><p>the random call of the first random effect.</p></dd>

  <dt id="arg-thetac">thetaC<a class="anchor" aria-label="anchor" href="#arg-thetac"></a></dt>
<dd><p>an optional matrix for constraints in the variance components.</p></dd>

    <dt id="arg-theta">theta<a class="anchor" aria-label="anchor" href="#arg-theta"></a></dt>
<dd><p>an optional symmetric matrix for initial values of the variance-covariance components. When providing customized values, these values should be scaled with respect to the original variance. For example, to provide an initial value of 1 to a given variance component, theta would be built as:</p>
<p>theta = matrix( 1 / var(response) )</p>
<p>The symmetric matrix should have as many rows and columns as the number of levels in the factor 'x'. The values in the matrix define the initial values of the variance-covariance components that will be subject to the constraints provided in thetaC. If not provided, initial values will be calculated as:</p>
<p>theta = diag(ncol(mm))*.05 + matrix(.1,ncol(mm),ncol(mm))</p>
<p>where mm is the incidence matrix for the factor 'x'.</p>
<p></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This implementation aims to fit models where covariance between random variables is expected to exist. For example, indirect genetic effects.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p></p><dl><dt>$Z</dt>
<dd><p>a incidence matrix Z* = Z Gamma which is the original incidence matrix for the timevar multiplied by the loadings.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>


<p>Covarrubias-Pazaran G (2016) Genome assisted prediction of quantitative traits using the R package sommer. PLoS ONE 11(6): doi:10.1371/journal.pone.0156744</p>
<p>Bijma, P. (2014). The quantitative genetics of indirect genetic effects: a selective review of modelling issues. Heredity, 112(1), 61-69.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Giovanny Covarrubias-Pazaran</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>The function <code><a href="vsc.html">vsc</a></code> to know how to use <code>covc</code> in the <code><a href="mmec.html">mmec</a></code> solver.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">DT_ige</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT_ige</span></span></span>
<span class="r-in"><span><span class="va">covRes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">DT</span>, <span class="fu">covc</span><span class="op">(</span> <span class="fu"><a href="vsc.html">vsc</a></span><span class="op">(</span><span class="fu"><a href="isc.html">isc</a></span><span class="op">(</span><span class="va">focal</span><span class="op">)</span><span class="op">)</span> , <span class="fu"><a href="vsc.html">vsc</a></span><span class="op">(</span><span class="fu"><a href="isc.html">isc</a></span><span class="op">(</span><span class="va">neighbour</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">covRes</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ Z          :List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ :Formal class 'dgCMatrix' [package "Matrix"] with 6 slots</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ i       : int [1:1000] 305 313 542 567 605 619 626 717 953 131 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ p       : int [1:99] 0 9 14 20 22 25 28 32 86 91 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ Dim     : int [1:2] 1000 98</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ Dimnames:List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. .. ..$ : chr [1:1000] "1" "2" "3" "4" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. .. ..$ : chr [1:98] "id_1019" "id_1101" "id_1137" "id_1268" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ x       : num [1:1000] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ factors : list()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ :Formal class 'dgCMatrix' [package "Matrix"] with 6 slots</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ i       : int [1:1000] 350 567 591 593 595 717 755 859 105 200 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ p       : int [1:99] 0 8 14 21 24 28 30 32 84 88 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ Dim     : int [1:2] 1000 98</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ Dimnames:List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. .. ..$ : chr [1:1000] "1" "2" "3" "4" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. .. ..$ : chr [1:98] "id_1019" "id_1101" "id_1137" "id_1268" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ x       : num [1:1000] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..@ factors : list()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ Gu         :Formal class 'dgCMatrix' [package "Matrix"] with 6 slots</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..@ i       : int [1:98] 0 1 2 3 4 5 6 7 8 9 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..@ p       : int [1:99] 0 1 2 3 4 5 6 7 8 9 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..@ Dim     : int [1:2] 98 98</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..@ Dimnames:List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ : chr [1:98] "id_1019" "id_1101" "id_1137" "id_1268" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ : chr [1:98] "id_1019" "id_1101" "id_1137" "id_1268" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..@ x       : num [1:98] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..@ factors : list()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ theta      : num [1:2, 1:2] 0.165 0.015 0.015 0.165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ thetaC     : num [1:2, 1:2] 1 0 2 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "dimnames")=List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ : chr [1:2] "ran1" "ran2"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ : chr [1:2] "ran1" "ran2"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ thetaF     : num[0 , 0 ] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ partitionsR: list()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ sp         : num(0) </span>
<span class="r-in"><span><span class="co"># look at DT_ige help page to see how to fit an actual model</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/covaruber" class="external-link">Giovanny Covarrubias-Pazaran</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

