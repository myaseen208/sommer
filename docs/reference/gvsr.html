<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>general variance structure specification — gvsr • sommer</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="general variance structure specification — gvsr"><meta name="description" content="gvsr function to build general variance-covariance structures for combination of random effects to be fitted in the mmer solver."><meta property="og:description" content="gvsr function to build general variance-covariance structures for combination of random effects to be fitted in the mmer solver."><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-116716530-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-116716530-2');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sommer</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">4.3.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-code"></span> Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-file-o"></span> Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/v1.sommer.quick.start.html">Quick Start</a></li>
    <li><a class="dropdown-item" href="../articles/v2.sommer.changes.and.faqs.html">FAQ</a></li>
    <li><a class="dropdown-item" href="../articles/v3.sommer.qg.html">Quantitative Genetics</a></li>
    <li><a class="dropdown-item" href="../articles/v4.sommer.gxe.html">GxE models</a></li>
    <li><a class="dropdown-item" href="../articles/v5.sommer.vs.lme4.html">sommer vs lme4</a></li>
    <li><a class="dropdown-item" href="../articles/v6.sommer.spatial.html">Spatial</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="https://github.com/covaruber/sommer" aria-label="GitHub repository"><span class="fa fa-github"></span> GitHub</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>general variance structure specification</h1>

      <div class="d-none name"><code>gvsr.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>gvsr</code> function to build general variance-covariance structures for combination of random effects to be fitted in the <code><a href="mmer.html">mmer</a></code> solver.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gvsr</span><span class="op">(</span><span class="va">...</span>, Gu<span class="op">=</span><span class="cn">NULL</span>, Guc<span class="op">=</span><span class="cn">NULL</span>, Gti<span class="op">=</span><span class="cn">NULL</span>, Gtc<span class="op">=</span><span class="cn">NULL</span>, form<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>names of the random effects (variables in the dataset) to be used to create a general variance structure. For example, for 2 random effects (variables); mom and progeny, a model specified as:</p>
<p><code>gvsr(mom, progeny)</code></p>
<p>will create a variance structure of the form:</p>
<p><code>| sigma2.m   sigma.pm |</code></p>
<p><code>| sigma.pm   sigma2.p |</code></p>
<p>where not only variance components for each random effect will be estimated but also the covariance component between the 2 random effects is estimated. The user can also provide a numeric vector or matrix to be considered the design matrix for the ith random effect. More than two random effects can be provided.</p>
<p></p></dd>


  <dt id="arg-gu">Gu<a class="anchor" aria-label="anchor" href="#arg-gu"></a></dt>
<dd><p>list of matrices with the known variance-covariance values for the levels of the different random effects provided in the "..." argument (i.e. relationship matrix among individuals or any other known covariance matrix). If NULL, then an identity matrix is assumed. For example, a model with 2 random effects with covariance structure should be provided as:</p>
<p><code>gvsr(mom, progeny, Gu=list(Am,Ap))</code></p>
<p>where <code>Am</code> and <code>Ap</code> are the relationship matrices for the random effects for mom and progeny respectively.</p>
<p></p></dd>


  <dt id="arg-guc">Guc<a class="anchor" aria-label="anchor" href="#arg-guc"></a></dt>
<dd><p>matrix with the constraints for the u random effects. This is used to specify which variance and covariance parameters between the 1 to 1 combinations of random effects should be estimated. For example, for 2 random effects the expected variance-covariance matrix expected to be estimated (when the default Guc=NULL) is and unstructured model:</p>
<p><code>| sigma2.m   sigma.pm |</code></p>
<p><code>| sigma.pm   sigma2.p |</code></p>
<p>but the user can constrain which parameters should be estimated. Providing:</p>
<p><code>Guc=diag(2)</code>     would fit:</p>
<p><code>| sigma2.m  ...0... |</code></p>
<p><code>| ...0...  sigma2.p |</code></p>
<p></p></dd>


  <dt id="arg-gti">Gti<a class="anchor" aria-label="anchor" href="#arg-gti"></a></dt>
<dd><p>matrix with dimensions t x t (t equal to number of traits) with initial values of the variance-covariance components for the random effect specified in the .... argument. If the value is NULL the program will provide the initial values.</p></dd>


  <dt id="arg-gtc">Gtc<a class="anchor" aria-label="anchor" href="#arg-gtc"></a></dt>
<dd><p>matrix with dimensions t x t (t equal to number of traits) of constraints for the variance-covariance components for the random effect specified in the ... argument according to the following rules:</p>
<p><code>0: not to be estimated</code></p>
<p><code>1: estimated and constrained to be positive (i.e. variance component)</code></p>
<p><code>2: estimated and unconstrained (can be negative or positive, i.e. covariance component)</code></p>
<p><code>3: not to be estimated but fixed (value has to be provided in the Gti argument)</code></p>
<p>In the multi-response scenario if the user doesn't specify this argument the default is to build an unstructured matrix (using the <code><a href="unsm.html">unsm</a></code>() function). This argument needs to be used wisely since some covariance among responses may not make sense. Useful functions to specify constraints are; <code><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></code>(), <code><a href="unsm.html">unsm</a></code>(), <code><a href="fixm.html">fixm</a></code>().</p></dd>


  <dt id="arg-form">form<a class="anchor" aria-label="anchor" href="#arg-form"></a></dt>
<dd><p>an additional structure to specify a kronecker product on top of the general covariance structure defined in the ... argument.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p></p><dl><dt>$res</dt>
<dd><p>a list with all neccesary elements (incidence matrices, known var-cov structures, unknown covariance structures to be estimated and constraints) to be used in the mmer solver.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Covarrubias-Pazaran G (2016) Genome assisted prediction of quantitative traits using the R package sommer. PLoS ONE 11(6): doi:10.1371/journal.pone.0156744</p>
<p>Covarrubias-Pazaran G (2018) Software update: Moving the R package sommer to
  multivariate mixed models for genome-assisted prediction. doi:
  https://doi.org/10.1101/354639</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Giovanny Covarrubias-Pazaran</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>The core function of the package: <code><a href="mmer.html">mmer</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">DT_ige</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT_ige</span></span></span>
<span class="r-in"><span><span class="va">Af</span> <span class="op">&lt;-</span> <span class="va">A_ige</span></span></span>
<span class="r-in"><span><span class="va">An</span> <span class="op">&lt;-</span> <span class="va">A_ige</span></span></span>
<span class="r-in"><span><span class="co">### Direct genetic effects model</span></span></span>
<span class="r-in"><span><span class="co"># modDGE &lt;- mmer(trait ~ block,</span></span></span>
<span class="r-in"><span><span class="co">#                random = ~ focal,</span></span></span>
<span class="r-in"><span><span class="co">#                rcov = ~ units, </span></span></span>
<span class="r-in"><span><span class="co">#                data = DT)</span></span></span>
<span class="r-in"><span><span class="co"># summary(modDGE)$varcomp</span></span></span>
<span class="r-in"><span><span class="co"># </span></span></span>
<span class="r-in"><span><span class="co">### Indirect genetic effects model without covariance between DGE and IGE</span></span></span>
<span class="r-in"><span><span class="co"># modDGE &lt;- mmer(trait ~ block,</span></span></span>
<span class="r-in"><span><span class="co">#                random = ~focal + neighbour,</span></span></span>
<span class="r-in"><span><span class="co">#                rcov = ~ units, </span></span></span>
<span class="r-in"><span><span class="co">#                data = DT)</span></span></span>
<span class="r-in"><span><span class="co"># summary(modDGE)$varcomp</span></span></span>
<span class="r-in"><span><span class="co"># </span></span></span>
<span class="r-in"><span><span class="co">### Indirect genetic effects model with covariance between DGE and IGE</span></span></span>
<span class="r-in"><span><span class="co"># modIGE &lt;- mmer(trait ~ block,</span></span></span>
<span class="r-in"><span><span class="co">#               random = ~ gvsr(focal, neighbour),</span></span></span>
<span class="r-in"><span><span class="co">#               rcov = ~ units, iters=4, </span></span></span>
<span class="r-in"><span><span class="co">#               data = DT)</span></span></span>
<span class="r-in"><span><span class="co"># summary(modIGE)$varcomp</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">### Indirect genetic effects model with covariance between DGE and IGE using relatioship matrices</span></span></span>
<span class="r-in"><span><span class="co"># modIGEb &lt;- mmer(trait ~ block,</span></span></span>
<span class="r-in"><span><span class="co">#                random = ~ gvsr(focal, neighbour, Gu=list(Af,An)),</span></span></span>
<span class="r-in"><span><span class="co">#                rcov = ~ units, </span></span></span>
<span class="r-in"><span><span class="co">#                data = DT)</span></span></span>
<span class="r-in"><span><span class="co"># summary(modIGEb)$varcomp</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/covaruber" class="external-link">Giovanny Covarrubias-Pazaran</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

