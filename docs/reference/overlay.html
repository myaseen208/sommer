<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Overlay Matrix — overlay • sommer</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Overlay Matrix — overlay"><meta name="description" content="`overlay` adds r times the design matrix for model term t to the existing design matrix. Specifically, if the model up to this point has p effects and t has a effects, the a columns of the design matrix for t are multiplied by the scalar r (default value 1.0). This can be used to force a correlation of 1 between two terms as in a diallel analysis."><meta property="og:description" content="`overlay` adds r times the design matrix for model term t to the existing design matrix. Specifically, if the model up to this point has p effects and t has a effects, the a columns of the design matrix for t are multiplied by the scalar r (default value 1.0). This can be used to force a correlation of 1 between two terms as in a diallel analysis."><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-116716530-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-116716530-2');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sommer</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">4.3.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-code"></span> Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-file-o"></span> Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/v1.sommer.quick.start.html">Quick Start</a></li>
    <li><a class="dropdown-item" href="../articles/v2.sommer.changes.and.faqs.html">FAQ</a></li>
    <li><a class="dropdown-item" href="../articles/v3.sommer.qg.html">Quantitative Genetics</a></li>
    <li><a class="dropdown-item" href="../articles/v4.sommer.gxe.html">GxE models</a></li>
    <li><a class="dropdown-item" href="../articles/v5.sommer.vs.lme4.html">sommer vs lme4</a></li>
    <li><a class="dropdown-item" href="../articles/v6.sommer.spatial.html">Spatial</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="https://github.com/covaruber/sommer" aria-label="GitHub repository"><span class="fa fa-github"></span> GitHub</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Overlay Matrix</h1>

      <div class="d-none name"><code>overlay.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>`overlay` adds r times the design matrix for model term t to the existing design matrix. Specifically, if the model up to this point has p effects and t has a effects, the a columns of the design matrix for t are multiplied by the scalar r (default value 1.0). This can be used to force a correlation of 1 between two terms as in a diallel analysis.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">overlay</span><span class="op">(</span><span class="va">...</span>, rlist<span class="op">=</span><span class="cn">NULL</span>, prefix<span class="op">=</span><span class="cn">NULL</span>, sparse<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>as many vectors as desired to overlay.</p></dd>

  <dt id="arg-rlist">rlist<a class="anchor" aria-label="anchor" href="#arg-rlist"></a></dt>
<dd><p>a list of scalar values indicating the times that each incidence matrix overlayed should be multiplied by. By default r=1.</p></dd>

  <dt id="arg-prefix">prefix<a class="anchor" aria-label="anchor" href="#arg-prefix"></a></dt>
<dd><p>a character name to be added before the column names of the final overlay matrix. This may be useful if you have entries with names starting with numbers which programs such as asreml doesn't like, or for posterior extraction of parameters, that way 'grep'ing is easier.</p></dd>

  <dt id="arg-sparse">sparse<a class="anchor" aria-label="anchor" href="#arg-sparse"></a></dt>
<dd><p>a TRUE/FALSE statement specifying if the matrices should be built as sparse or regular matrices.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p></p><dl><dt>$S3</dt>
<dd><p>an incidence matrix with as many columns levels in the vectors provided to build the incidence matrix.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Fikret Isik. 2009. Analysis of Diallel Mating Designs. North Carolina State University, Raleigh, USA.</p>
<p>Covarrubias-Pazaran G (2016) Genome assisted prediction of quantitative traits using the R package sommer. PLoS ONE 11(6): doi:10.1371/journal.pone.0156744</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Giovanny Covarrubias-Pazaran</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>The core functions of the package <code><a href="mmer.html">mmer</a></code> and a function for creating dummy variables for diallel models named <code><a href="add.diallel.vars.html">add.diallel.vars</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co">####=========================================####</span></span></span>
<span class="r-in"><span><span class="co">#### For CRAN time limitations most lines in the </span></span></span>
<span class="r-in"><span><span class="co">#### examples are silenced with one '#' mark, </span></span></span>
<span class="r-in"><span><span class="co">#### remove them and run the examples</span></span></span>
<span class="r-in"><span><span class="co">####=========================================####</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"DT_halfdiallel"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT_halfdiallel</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   rep geno male female     sugar</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   1   12    1      2 13.950509</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   2   12    1      2  9.756918</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   1   13    1      3 13.906355</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   2   13    1      3  9.119455</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   1   14    1      4  5.174483</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   2   14    1      4  8.452221</span>
<span class="r-in"><span><span class="va">DT</span><span class="op">$</span><span class="va">femalef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">female</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">DT</span><span class="op">$</span><span class="va">malef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">male</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">DT</span><span class="op">$</span><span class="va">genof</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">geno</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">DT</span>, <span class="fu">overlay</span><span class="op">(</span><span class="va">femalef</span>,<span class="va">malef</span>, sparse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42 x 7 sparse Matrix of class "dgCMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1 2 3 4 5 6 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1 1 . . . . .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  1 1 . . . . .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  1 . 1 . . . .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  1 . 1 . . . .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  1 . . 1 . . .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  1 . . 1 . . .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  1 . . . 1 . .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  1 . . . 1 . .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  1 . . . . 1 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 1 . . . . 1 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 1 . . . . . 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 1 . . . . . 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 . 1 1 . . . .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 . 1 1 . . . .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 . 1 . 1 . . .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 . 1 . 1 . . .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 . 1 . . 1 . .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 . 1 . . 1 . .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 . 1 . . . 1 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 . 1 . . . 1 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 . 1 . . . . 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 . 1 . . . . 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 . . 1 1 . . .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 . . 1 1 . . .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 . . 1 . 1 . .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26 . . 1 . 1 . .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27 . . 1 . . 1 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 . . 1 . . 1 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29 . . 1 . . . 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 . . 1 . . . 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 . . . 1 1 . .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32 . . . 1 1 . .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33 . . . 1 . 1 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34 . . . 1 . 1 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35 . . . 1 . . 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36 . . . 1 . . 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37 . . . . 1 1 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38 . . . . 1 1 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39 . . . . 1 . 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40 . . . . 1 . 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41 . . . . . 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42 . . . . . 1 1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">DT</span>, <span class="fu">overlay</span><span class="op">(</span><span class="va">femalef</span>,<span class="va">malef</span>, sparse <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1 2 3 4 5 6 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1 1 0 0 0 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  1 1 0 0 0 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  1 0 1 0 0 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  1 0 1 0 0 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  1 0 0 1 0 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  1 0 0 1 0 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  1 0 0 0 1 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  1 0 0 0 1 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  1 0 0 0 0 1 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 1 0 0 0 0 1 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 1 0 0 0 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 1 0 0 0 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 0 1 1 0 0 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 0 1 1 0 0 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 0 1 0 1 0 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 0 1 0 1 0 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 0 1 0 0 1 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 0 1 0 0 1 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 0 1 0 0 0 1 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 0 1 0 0 0 1 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 0 1 0 0 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 0 1 0 0 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 0 0 1 1 0 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 0 0 1 1 0 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 0 0 1 0 1 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26 0 0 1 0 1 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27 0 0 1 0 0 1 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 0 0 1 0 0 1 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29 0 0 1 0 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 0 0 1 0 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 0 0 0 1 1 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32 0 0 0 1 1 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33 0 0 0 1 0 1 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34 0 0 0 1 0 1 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35 0 0 0 1 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36 0 0 0 1 0 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37 0 0 0 0 1 1 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38 0 0 0 0 1 1 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39 0 0 0 0 1 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40 0 0 0 0 1 0 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41 0 0 0 0 0 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42 0 0 0 0 0 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"variables")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "femalef" "malef"  </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/covaruber" class="external-link">Giovanny Covarrubias-Pazaran</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

