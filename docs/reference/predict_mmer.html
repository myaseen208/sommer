<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Predict form of a LMM fitted with mmer — predict.mmer • sommer</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Predict form of a LMM fitted with mmer — predict.mmer"><meta name="description" content='predict method for class "mmer".'><meta property="og:description" content='predict method for class "mmer".'><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-116716530-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-116716530-2');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sommer</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">4.3.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-code"></span> Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-file-o"></span> Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/v1.sommer.quick.start.html">Quick Start</a></li>
    <li><a class="dropdown-item" href="../articles/v2.sommer.changes.and.faqs.html">FAQ</a></li>
    <li><a class="dropdown-item" href="../articles/v3.sommer.qg.html">Quantitative Genetics</a></li>
    <li><a class="dropdown-item" href="../articles/v4.sommer.gxe.html">GxE models</a></li>
    <li><a class="dropdown-item" href="../articles/v5.sommer.vs.lme4.html">sommer vs lme4</a></li>
    <li><a class="dropdown-item" href="../articles/v6.sommer.spatial.html">Spatial</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="https://github.com/covaruber/sommer" aria-label="GitHub repository"><span class="fa fa-github"></span> GitHub</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Predict form of a LMM fitted with mmer</h1>

      <div class="d-none name"><code>predict_mmer.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>predict</code> method for class <code>"mmer"</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'mmer'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">object</span>, Dtable<span class="op">=</span><span class="cn">NULL</span>, <span class="va">D</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>a mixed model of class <code>"mmer"</code></p></dd>

 <dt id="arg-dtable">Dtable<a class="anchor" aria-label="anchor" href="#arg-dtable"></a></dt>
<dd><p>a table specifying the terms to be included or averaged.</p>
<p>An "include" term means that the model matrices for that fixed or random effect is filled with 1's for the positions where column names and row names match.</p>
<p>An "include and average" term means that the model matrices for that fixed or random effect is filled with 1/#1's in that row.</p>
<p>An "average" term alone means that all rows for such fixed or random effect will be filled with 1/#levels in the effect.</p>
<p>If a term is not considered "include" or "average" is then totally ignored in the BLUP and SE calculation.</p>
<p>The default rule to invoke when the user doesn't provide the Dtable is to include and average all terms that match the argument D.</p>
<p></p></dd>

 <dt id="arg-d">D<a class="anchor" aria-label="anchor" href="#arg-d"></a></dt>
<dd><p>a character string specifying the variable used to extract levels for the rows of the D matrix and its construction. Alternatively, the D matrix (of class dgCMatrix) specifying the matrix to be used for the predictions directly.</p></dd>

 <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments to be passed.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function allows to produce predictions specifying those variables that define the margins of the hypertable to be predicted (argument D). Predictions are obtained for each combination of values of the specified variables that is present in the data set used to fit the model. See vignettes for more details.</p>
<p>For predicted values the pertinent design matrices X and Z together with BLUEs (b) and BLUPs (u) are multiplied and added together.</p>
<p>predicted.value equal Xb + Zu.1 + ... + Zu.n</p>
<p>For computing standard errors for predictions the parts of the coefficient matrix:</p>
<p>C11 equal (X.t() V.inv() X).inv()</p>
<p>C12 equal 0 - [(X.t() V.inv() X).inv() X.t() V.inv() G Z]</p>
<p>C22 equal PEV equal G - [Z.t() G[V.inv() - (V.inv() X X.t() V.inv() X V.inv() X)]G Z.t()]</p>
<p>In practive C equals ( W.t() V.inv() W ).inv()</p>
<p>when both fixed and random effects are present in the inclusion set. If only fixed and random effects are included, only the respective terms from the SE for fixed or random effects are calculated.</p>
<p></p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>


<p></p>
<dl><dt>pvals</dt>
<dd><p>the table of predictions according to the specified arguments.</p></dd>


  <dt>vcov</dt>
<dd><p>the variance covariance for the predictions.</p></dd>


  <dt>D</dt>
<dd><p>the model matrix for predictions as defined in Welham et al.(2004).</p></dd>


  <dt>Dtable</dt>
<dd><p>the table specifying the terms to include and terms to be averaged.</p></dd>


 </dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Welham, S., Cullis, B., Gogel, B., Gilmour, A., and Thompson, R. (2004). Prediction in linear mixed models. Australian and New Zealand Journal of Statistics, 46, 325 - 347.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Giovanny Covarrubias</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></code>, <code><a href="mmer.html">mmer</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">DT_yatesoats</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT_yatesoats</span></span></span>
<span class="r-in"><span><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="mmer.html">mmer</a></span><span class="op">(</span>fixed<span class="op">=</span><span class="va">Y</span> <span class="op">~</span> <span class="va">V</span> <span class="op">+</span> <span class="va">N</span> <span class="op">+</span> <span class="va">V</span><span class="op">:</span><span class="va">N</span> ,</span></span>
<span class="r-in"><span>           random <span class="op">=</span> <span class="op">~</span> <span class="va">B</span> <span class="op">+</span> <span class="va">B</span><span class="op">:</span><span class="va">MP</span>,</span></span>
<span class="r-in"><span>           rcov<span class="op">=</span><span class="op">~</span><span class="va">units</span>,</span></span>
<span class="r-in"><span>           data <span class="op">=</span> <span class="va">DT</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iteration    LogLik     wall    cpu(sec)   restrained</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1      -4.46709   1:16:21      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2      -1.34644   1:16:21      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3      -0.788146   1:16:21      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     4      -0.746308   1:16:21      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     5      -0.745925   1:16:21      0           0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#############################</span></span></span>
<span class="r-in"><span><span class="co">## predict means for nitrogen</span></span></span>
<span class="r-in"><span><span class="co">#############################</span></span></span>
<span class="r-in"><span><span class="va">pp</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span>object<span class="op">=</span><span class="va">m3</span>, D<span class="op">=</span><span class="st">"N"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pp</span><span class="op">$</span><span class="va">pvals</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       N predicted.value std.error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0     0         80.0000  9.106654</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.2 0.2         98.5000  9.106654</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.4 0.4        114.6667  9.106654</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.6 0.6        124.8333  9.106654</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#############################</span></span></span>
<span class="r-in"><span><span class="co">## predict means for variety</span></span></span>
<span class="r-in"><span><span class="co">#############################</span></span></span>
<span class="r-in"><span><span class="va">pp</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span>object<span class="op">=</span><span class="va">m3</span>, D<span class="op">=</span><span class="st">"V"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pp</span><span class="op">$</span><span class="va">pvals</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     V predicted.value std.error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GoldenRain GoldenRain        80.00000  9.106654</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marvellous Marvellous        86.66667  9.106654</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ictory         ictory        71.50000  9.106654</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/covaruber" class="external-link">Giovanny Covarrubias-Pazaran</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

