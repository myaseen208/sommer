<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>reduced rank covariance structure — rrc • sommer</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="reduced rank covariance structure — rrc"><meta name="description" content="rrc creates a reduced rank factor analytic covariance structure by selecting the n vectors of the L matrix of the Cholesky decomposition or the U vectors of the SVD decomposition (loadings or latent covariates) to create a new incidence matrix of latent covariates that can be used with the mmec solver to fit random regressions on the latent covariates."><meta property="og:description" content="rrc creates a reduced rank factor analytic covariance structure by selecting the n vectors of the L matrix of the Cholesky decomposition or the U vectors of the SVD decomposition (loadings or latent covariates) to create a new incidence matrix of latent covariates that can be used with the mmec solver to fit random regressions on the latent covariates."><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-116716530-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-116716530-2');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sommer</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">4.3.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-code"></span> Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-file-o"></span> Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/v1.sommer.quick.start.html">Quick Start</a></li>
    <li><a class="dropdown-item" href="../articles/v2.sommer.changes.and.faqs.html">FAQ</a></li>
    <li><a class="dropdown-item" href="../articles/v3.sommer.qg.html">Quantitative Genetics</a></li>
    <li><a class="dropdown-item" href="../articles/v4.sommer.gxe.html">GxE models</a></li>
    <li><a class="dropdown-item" href="../articles/v5.sommer.vs.lme4.html">sommer vs lme4</a></li>
    <li><a class="dropdown-item" href="../articles/v6.sommer.spatial.html">Spatial</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="https://github.com/covaruber/sommer" aria-label="GitHub repository"><span class="fa fa-github"></span> GitHub</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>reduced rank covariance structure</h1>

      <div class="d-none name"><code>rrc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>rrc</code> creates a reduced rank factor analytic covariance structure by selecting the n vectors of the L matrix of the Cholesky decomposition or the U vectors of the SVD decomposition (loadings or latent covariates) to create a new incidence matrix of latent covariates that can be used with the <code><a href="mmec.html">mmec</a></code> solver to fit random regressions on the latent covariates.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rrc</span><span class="op">(</span>x<span class="op">=</span><span class="cn">NULL</span>, H<span class="op">=</span><span class="cn">NULL</span>, nPC<span class="op">=</span><span class="fl">2</span>, returnGamma<span class="op">=</span><span class="cn">FALSE</span>, cholD<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>vector of the dataset containing the variable to be used to form the incidence matrix.</p></dd>

  <dt id="arg-h">H<a class="anchor" aria-label="anchor" href="#arg-h"></a></dt>
<dd><p>two-way table of identifiers (rows; e.g., genotypes) by features (columns; e.g., environments) effects. Row names and column names are required. No missing data is allowed.</p></dd>

  <dt id="arg-npc">nPC<a class="anchor" aria-label="anchor" href="#arg-npc"></a></dt>
<dd><p>number of principal components to keep from the loadings matrix.</p></dd>

  <dt id="arg-returngamma">returnGamma<a class="anchor" aria-label="anchor" href="#arg-returngamma"></a></dt>
<dd><p>a TRUE/FALSE argument specifying if the function should return the matrix of loadings used to build the incidence matrix for the model. The default is FALSE so it returns only the incidence matrix.</p></dd>

  <dt id="arg-chold">cholD<a class="anchor" aria-label="anchor" href="#arg-chold"></a></dt>
<dd><p>a TRUE/FALSE argument specifying if the Cholesky decomposition should be calculated or the singular value decomposition should be used instead.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This implementation of a version of the reduced rank factor analytic models uses the so-called principal component (PC) models (Meyer, 2009) which assumes specific effects (psi) are equal to 0. The model is as follows:</p>
<p>y = Xb + Zu + e</p>
<p>where the variance of u ~ MVN(0, Sigma)</p>
<p>Sigma = (Gamma_t Gamma) + Psi</p>
<p><strong>Extended factor analytic model</strong>:</p>
<p>y = Xb + Z(I Gamma)c + Zs + e = Xb + Z*c + Zs + e</p>
<p>where <code>y</code> is the response variable, <code>X</code> and <code>Z</code> are incidence matrices for fixed and random effects respectively, <code>I</code> is a diagonal matrix, <code>Gamma</code> are the factor loadings for <code>c</code> common factor scores, and <code>s</code> are the specific effects, <code>e</code> is the vector of residuals.</p>
<p><strong>Reduced rank model:</strong></p>
<p>y = Xb + Z(I Gamma)c + e = Xb + Z*c + e</p>
<p>which is equal to the one above but assumes specific effects = 0.</p>
<p><strong>The algorithm in rrc the following:</strong></p>
<p>1) uses a wide-format table of timevar (m columns) by idvar (q rows) named H to form the initial variance-covariance matrix (Sigma) which is calculated as Sigma = H'H of dimensions m x m (column dimensions, e.g., environments x environments).</p>
<p>2) The Sigma matrix is then center and scaled.</p>
<p>3) A Cholesky (L matrix) or SVD decomposition (U D V') is performed in the Sigma matrix.</p>
<p>4) n vectors from L (when Cholesky is used) or U sqrt(D) (when SVD is used) are kept to form Gamma. Gamma = L[,1:nPc] or Gamma = U[,1:nPC]. These are the so-called loadings (L for all loadings, Gamma for the subset of loadings).</p>
<p>4) Gamma is used to form a new incidence matrix as Z* = Z Gamma</p>
<p>5) This matrix is later used for the REML machinery to be used with the usc (unstructured) or dsc (diagonal) structures to estimate variance components and factor scores. The resulting BLUPs from the mixed model are the optimized factor scores. Pretty much as a random regression over latent covariates.</p>
<p>This implementation does not update the loadings (latent covariates) during the REML process, only estimates the REML factor scores for fixed loadings. This is different to other software (e.g., asreml) where the loadings are updated during the REML process as well.</p>
<p>BLUPs for genotypes in all locations can be recovered as:</p>
<p>u = Gamma * u_scores</p>
<p>The resulting loadings (Gamma) and factor scores can be thought as an equivalent to the classical factor analysis.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p></p><dl><dt>$Z</dt>
<dd><p>a incidence matrix Z* = Z Gamma which is the original incidence matrix for the timevar multiplied by the loadings.</p></dd>


    <dt>$Gamma</dt>
<dd><p>a matrix of loadings or latent covariates.</p></dd>


    <dt>$Sigma</dt>
<dd><p>the covariance matrix used to calculate Gamma.</p></dd>



</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>


<p>Covarrubias-Pazaran G (2016) Genome assisted prediction of quantitative traits using the R package sommer. PLoS ONE 11(6): doi:10.1371/journal.pone.0156744</p>
<p>Meyer K (2009) Factor analytic models for genotype by environment type problems and structured covariance matrices. Genetics Selection Evolution, 41:21</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Giovanny Covarrubias-Pazaran</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>The function <code><a href="vsc.html">vsc</a></code> to know how to use <code>rrc</code> in the <code><a href="mmec.html">mmec</a></code> solver.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">DT_h2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT_h2</span></span></span>
<span class="r-in"><span><span class="va">DT</span><span class="op">=</span><span class="va">DT</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">DT</span>, <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">Env</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Name     Env Loc Year     Block  y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67   MSL007-B CA.2011  CA 2011 CA.2011.2  5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 105  MSL007-B CA.2011  CA 2011 CA.2011.1  6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 308  MSK061-4 CA.2011  CA 2011 CA.2011.2  9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 393  MSK061-4 CA.2011  CA 2011 CA.2011.1 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 469 MSR169-8Y CA.2011  CA 2011 CA.2011.1 11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 471     NY148 CA.2011  CA 2011 CA.2011.1 11</span>
<span class="r-in"><span><span class="va">indNames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">Name</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">indNames</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">indNames</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co"># fit diagonal model first to produce H matrix</span></span></span>
<span class="r-in"><span><span class="va">ansDG</span> <span class="op">&lt;-</span> <span class="fu"><a href="mmec.html">mmec</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">Env</span>,</span></span>
<span class="r-in"><span>              random<span class="op">=</span><span class="op">~</span> <span class="fu"><a href="vsc.html">vsc</a></span><span class="op">(</span><span class="fu"><a href="dsc.html">dsc</a></span><span class="op">(</span><span class="va">Env</span><span class="op">)</span>, <span class="fu"><a href="isc.html">isc</a></span><span class="op">(</span><span class="va">Name</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              rcov<span class="op">=</span><span class="op">~</span><span class="va">units</span>, nIters <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>              <span class="co"># we recommend giving more EM iterations at the beggining</span></span></span>
<span class="r-in"><span>              emWeight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">10</span><span class="op">)</span>,<span class="fu"><a href="logspace.html">logspace</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">1</span>,<span class="fl">.05</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">.05</span>,<span class="fl">80</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              data<span class="op">=</span><span class="va">DT</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iteration    LogLik     wall    cpu(sec)   restrained</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1      -1509.65   1:16:24      1           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2      -1457.08   1:16:25      2           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3      -1407.42   1:16:26      3           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     4      -1368.55   1:16:27      4           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     5      -1343.65   1:16:27      4           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     6      -1327.76   1:16:28      5           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     7      -1318.84   1:16:29      6           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     8      -1314.21   1:16:30      7           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     9      -1311.84   1:16:31      8           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     10      -1310.57   1:16:32      9           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     11      -1309.85   1:16:33      10           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     12      -1309.4   1:16:33      10           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     13      -1308.98   1:16:34      11           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     14      -1308.62   1:16:35      12           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     15      -1308.29   1:16:36      13           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     16      -1308.01   1:16:37      14           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     17      -1307.77   1:16:38      15           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     18      -1307.58   1:16:39      16           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     19      -1307.44   1:16:40      17           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     20      -1307.33   1:16:40      17           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     21      -1307.27   1:16:41      18           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     22      -1307.46   1:16:42      19           0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">H0</span> <span class="op">&lt;-</span> <span class="va">ansDG</span><span class="op">$</span><span class="va">uList</span><span class="op">$</span><span class="va">`vsc(dsc(Env), isc(Name))`</span> <span class="co"># GxE table</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># reduced rank model</span></span></span>
<span class="r-in"><span><span class="va">ansFA</span> <span class="op">&lt;-</span> <span class="fu"><a href="mmec.html">mmec</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">Env</span>,</span></span>
<span class="r-in"><span>              random<span class="op">=</span><span class="op">~</span><span class="fu"><a href="vsc.html">vsc</a></span><span class="op">(</span> <span class="fu"><a href="usc.html">usc</a></span><span class="op">(</span><span class="fu">rrc</span><span class="op">(</span><span class="va">Env</span>, H <span class="op">=</span> <span class="va">H0</span>, nPC <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span> , <span class="fu"><a href="isc.html">isc</a></span><span class="op">(</span><span class="va">Name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># rr</span></span></span>
<span class="r-in"><span>                <span class="fu"><a href="vsc.html">vsc</a></span><span class="op">(</span><span class="fu"><a href="dsc.html">dsc</a></span><span class="op">(</span><span class="va">Env</span><span class="op">)</span>, <span class="fu"><a href="isc.html">isc</a></span><span class="op">(</span><span class="va">Name</span><span class="op">)</span><span class="op">)</span>, <span class="co"># diag</span></span></span>
<span class="r-in"><span>              rcov<span class="op">=</span><span class="op">~</span><span class="va">units</span>,</span></span>
<span class="r-in"><span>              <span class="co"># we recommend giving more iterations to these models</span></span></span>
<span class="r-in"><span>              nIters <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>              <span class="co"># we recommend giving more EM iterations at the beggining</span></span></span>
<span class="r-in"><span>              emWeight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">10</span><span class="op">)</span>,<span class="fu"><a href="logspace.html">logspace</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">1</span>,<span class="fl">.05</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">.05</span>,<span class="fl">80</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              data<span class="op">=</span><span class="va">DT</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iteration    LogLik     wall    cpu(sec)   restrained</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1      -1496.12   1:16:44      2           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2      -1428.93   1:16:46      4           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3      -1364.34   1:16:47      5           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     4      -1319.74   1:16:49      7           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     5      -1298.08   1:16:51      9           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     6      -1286.14   1:16:52      10           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     7      -1279.67   1:16:54      12           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     8      -1276.14   1:16:56      14           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     9      -1274.06   1:16:57      15           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     10      -1272.67   1:16:59      17           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     11      -1271.65   1:17:1      19           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     12      -1270.85   1:17:2      20           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     13      -1269.94   1:17:4      22           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     14      -1268.97   1:17:6      24           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     15      -1267.96   1:17:8      26           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     16      -1266.99   1:17:9      27           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     17      -1266.1   1:17:11      29           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     18      -1265.33   1:17:13      31           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     19      -1264.69   1:17:14      32           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     20      -1264.19   1:17:16      34           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     21      -1263.8   1:17:18      36           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     22      -1263.61   1:17:19      37           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     23      -1264.2   1:17:21      39           0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">vcFA</span> <span class="op">&lt;-</span> <span class="va">ansFA</span><span class="op">$</span><span class="va">theta</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">vcDG</span> <span class="op">&lt;-</span> <span class="va">ansFA</span><span class="op">$</span><span class="va">theta</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">loadings</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">DT</span>, <span class="fu">rrc</span><span class="op">(</span><span class="va">Env</span>, nPC <span class="op">=</span> <span class="fl">3</span>, H <span class="op">=</span> <span class="va">H0</span>, returnGamma <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">)</span><span class="op">$</span><span class="va">Gamma</span></span></span>
<span class="r-in"><span><span class="va">scores</span> <span class="op">&lt;-</span> <span class="va">ansFA</span><span class="op">$</span><span class="va">uList</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">vcUS</span> <span class="op">&lt;-</span> <span class="va">loadings</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">vcFA</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">loadings</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">G</span> <span class="op">&lt;-</span> <span class="va">vcUS</span> <span class="op">+</span> <span class="va">vcDG</span></span></span>
<span class="r-in"><span><span class="co"># colfunc &lt;- colorRampPalette(c("steelblue4","springgreen","yellow"))</span></span></span>
<span class="r-in"><span><span class="co"># hv &lt;- heatmap(cov2cor(G), col = colfunc(100), symm = TRUE)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">uFA</span> <span class="op">&lt;-</span> <span class="va">scores</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">loadings</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">uDG</span> <span class="op">&lt;-</span> <span class="va">ansFA</span><span class="op">$</span><span class="va">uList</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">u</span> <span class="op">&lt;-</span> <span class="va">uFA</span> <span class="op">+</span> <span class="va">uDG</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/covaruber" class="external-link">Giovanny Covarrubias-Pazaran</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

