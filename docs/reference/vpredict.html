<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>vpredict form of a LMM fitted with mmer — vpredict • sommer</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="vpredict form of a LMM fitted with mmer — vpredict"><meta name="description" content='vpredict method for class "mmer".
Post-analysis procedure to calculate linear combinations of variance components. Its intended use is when the variance components are either simple variances or are variances and covariances in an unstructured matrix. The functions covered are linear combinations of the variance components (for example, phenotypic variance), a ratio of two components (for example, heritabilities) and the correlation based on three components (for example, genetic correlation).
The calculations are based on the estimated variance parameters and their variance matrix as represented by the inverse of the Fisher or Average information matrix. Note that this matrix has zero values for fixed variance parameters including those near the parameter space boundary.
The transform is specified with a formula. On the left side of the formula is a name for the transformation. On the right side of the formula is a transformation specified with shortcut names like `V1`, `V2`, etc.  The easiest way to identify these shortcut names is to use `summary(object)$varcomp`. The rows of this object can referred to with shortcuts `V1`, `V2`, etc.  See the example below.'><meta property="og:description" content='vpredict method for class "mmer".
Post-analysis procedure to calculate linear combinations of variance components. Its intended use is when the variance components are either simple variances or are variances and covariances in an unstructured matrix. The functions covered are linear combinations of the variance components (for example, phenotypic variance), a ratio of two components (for example, heritabilities) and the correlation based on three components (for example, genetic correlation).
The calculations are based on the estimated variance parameters and their variance matrix as represented by the inverse of the Fisher or Average information matrix. Note that this matrix has zero values for fixed variance parameters including those near the parameter space boundary.
The transform is specified with a formula. On the left side of the formula is a name for the transformation. On the right side of the formula is a transformation specified with shortcut names like `V1`, `V2`, etc.  The easiest way to identify these shortcut names is to use `summary(object)$varcomp`. The rows of this object can referred to with shortcuts `V1`, `V2`, etc.  See the example below.'><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-116716530-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-116716530-2');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sommer</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">4.3.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-code"></span> Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-file-o"></span> Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/v1.sommer.quick.start.html">Quick Start</a></li>
    <li><a class="dropdown-item" href="../articles/v2.sommer.changes.and.faqs.html">FAQ</a></li>
    <li><a class="dropdown-item" href="../articles/v3.sommer.qg.html">Quantitative Genetics</a></li>
    <li><a class="dropdown-item" href="../articles/v4.sommer.gxe.html">GxE models</a></li>
    <li><a class="dropdown-item" href="../articles/v5.sommer.vs.lme4.html">sommer vs lme4</a></li>
    <li><a class="dropdown-item" href="../articles/v6.sommer.spatial.html">Spatial</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="https://github.com/covaruber/sommer" aria-label="GitHub repository"><span class="fa fa-github"></span> GitHub</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>vpredict form of a LMM fitted with mmer</h1>

      <div class="d-none name"><code>vpredict.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>vpredict</code> method for class <code>"mmer"</code>.</p>
<p>Post-analysis procedure to calculate linear combinations of variance components. Its intended use is when the variance components are either simple variances or are variances and covariances in an unstructured matrix. The functions covered are linear combinations of the variance components (for example, phenotypic variance), a ratio of two components (for example, heritabilities) and the correlation based on three components (for example, genetic correlation).</p>
<p>The calculations are based on the estimated variance parameters and their variance matrix as represented by the inverse of the Fisher or Average information matrix. Note that this matrix has zero values for fixed variance parameters including those near the parameter space boundary.</p>
<p>The transform is specified with a formula. On the left side of the formula is a name for the transformation. On the right side of the formula is a transformation specified with shortcut names like `V1`, `V2`, etc.  The easiest way to identify these shortcut names is to use `summary(object)$varcomp`. The rows of this object can referred to with shortcuts `V1`, `V2`, etc.  See the example below.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">vpredict</span><span class="op">(</span><span class="va">object</span>, <span class="va">transform</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'mmer'</span></span>
<span><span class="fu">vpredict</span><span class="op">(</span><span class="va">object</span>, <span class="va">transform</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<p></p>
<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>a model fitted with the mmer function.</p></dd>


 <dt id="arg-transform">transform<a class="anchor" aria-label="anchor" href="#arg-transform"></a></dt>
<dd><p>a formula to calculate the function.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>


<p>The delta method (e.g., Lynch and Walsh 1998, Appendix 1; Ver Hoef 2012) uses
  a Taylor series expansion to approximate the moments of a function of
  parameters. Here, a second-order Taylor series expansion is implemented to
  approximate the standard error for a function of (co)variance parameters.
  Partial first derivatives of the function are calculated by algorithmic
  differentiation with <code><a href="https://rdrr.io/r/stats/deriv.html" class="external-link">deriv</a></code>.</p>
<p>Though <code>vpredict</code> can calculate standard errors for non-linear functions
  of (co)variance parameters from a fitted <code>mmer</code> model, it is limited
  to non-linear functions constructed by mathematical operations such as the
  arithmetic operators <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code> and <code>^</code>,
  and single-variable functions such as  <code>exp</code> and <code>log</code>. See
  <code><a href="https://rdrr.io/r/stats/deriv.html" class="external-link">deriv</a></code> for more information.</p>
<p></p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>


<p></p>
<dl><dt>dd</dt>
<dd><p>the parameter and its standard error.</p></dd>


 </dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Covarrubias-Pazaran G (2016) Genome assisted prediction of quantitative traits using the R package sommer. PLoS ONE 11(6): doi:10.1371/journal.pone.0156744</p>
<p>Lynch, M. and B. Walsh 1998. Genetics and Analysis of Quantitative Traits. Sinauer Associates, Inc., Sunderland, MA, USA.</p>
<p>Ver Hoef, J.M. 2012. Who invented the delta method? The American Statistician 66:124-127. DOI: 10.1080/00031305.2012.687494</p>
<p></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Giovanny Covarrubias</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code>vpredict</code>, <code><a href="mmer.html">mmer</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####=========================================####</span></span></span>
<span class="r-in"><span><span class="co">####=========================================####</span></span></span>
<span class="r-in"><span><span class="co">#### EXAMPLE 1</span></span></span>
<span class="r-in"><span><span class="co">#### simple example with univariate models</span></span></span>
<span class="r-in"><span><span class="co">####=========================================####</span></span></span>
<span class="r-in"><span><span class="co">####=========================================####</span></span></span>
<span class="r-in"><span><span class="co"># data(DT_cpdata)</span></span></span>
<span class="r-in"><span><span class="co"># DT &lt;- DT_cpdata</span></span></span>
<span class="r-in"><span><span class="co"># GT &lt;- GT_cpdata</span></span></span>
<span class="r-in"><span><span class="co"># MP &lt;- MP_cpdata</span></span></span>
<span class="r-in"><span><span class="co"># #### create the variance-covariance matrix </span></span></span>
<span class="r-in"><span><span class="co"># A &lt;- A.mat(GT)</span></span></span>
<span class="r-in"><span><span class="co"># #### look at the data and fit the model</span></span></span>
<span class="r-in"><span><span class="co"># head(DT)</span></span></span>
<span class="r-in"><span><span class="co"># mix1 &lt;- mmer(Yield~1,</span></span></span>
<span class="r-in"><span><span class="co">#               random=~vsr(id,Gu=A), </span></span></span>
<span class="r-in"><span><span class="co">#               data=DT)</span></span></span>
<span class="r-in"><span><span class="co"># summary(mix1)$varcomp</span></span></span>
<span class="r-in"><span><span class="co"># #### run the vpredict function</span></span></span>
<span class="r-in"><span><span class="co"># vpredict(mix1, h2 ~ V1 / ( V1 + V2 ) )</span></span></span>
<span class="r-in"><span><span class="co"># </span></span></span>
<span class="r-in"><span><span class="co"># ####=========================================####</span></span></span>
<span class="r-in"><span><span class="co"># ####=========================================####</span></span></span>
<span class="r-in"><span><span class="co"># #### EXAMPLE 2</span></span></span>
<span class="r-in"><span><span class="co"># #### simple example with multivariate models</span></span></span>
<span class="r-in"><span><span class="co"># ####=========================================####</span></span></span>
<span class="r-in"><span><span class="co"># ####=========================================####</span></span></span>
<span class="r-in"><span><span class="co"># data(DT_cpdata)</span></span></span>
<span class="r-in"><span><span class="co"># DT &lt;- DT_cpdata</span></span></span>
<span class="r-in"><span><span class="co"># GT &lt;- GT_cpdata</span></span></span>
<span class="r-in"><span><span class="co"># MP &lt;- MP_cpdata</span></span></span>
<span class="r-in"><span><span class="co"># #### create the variance-covariance matrix </span></span></span>
<span class="r-in"><span><span class="co"># A &lt;- A.mat(GT)</span></span></span>
<span class="r-in"><span><span class="co"># #### look at the data and fit the model</span></span></span>
<span class="r-in"><span><span class="co"># head(DT)</span></span></span>
<span class="r-in"><span><span class="co"># mix2 &lt;- mmer(cbind(Yield,color)~1,</span></span></span>
<span class="r-in"><span><span class="co">#                random=~vsr(id,Gu=A, Gt=unsm(2)), </span></span></span>
<span class="r-in"><span><span class="co">#                rcov=~vsr(units, Gt=unsm(2)),</span></span></span>
<span class="r-in"><span><span class="co">#               data=DT)</span></span></span>
<span class="r-in"><span><span class="co"># summary(mix2)$varcomp</span></span></span>
<span class="r-in"><span><span class="co"># ## genetic correlation</span></span></span>
<span class="r-in"><span><span class="co"># vpredict(mix2, gen.cor ~ V2 / sqrt(V1*V3))</span></span></span>
<span class="r-in"><span><span class="co"># </span></span></span>
<span class="r-in"><span><span class="co"># ####=========================================####</span></span></span>
<span class="r-in"><span><span class="co"># ####=========================================####</span></span></span>
<span class="r-in"><span><span class="co"># #### EXAMPLE 3</span></span></span>
<span class="r-in"><span><span class="co"># #### more complex multivariate model</span></span></span>
<span class="r-in"><span><span class="co"># ####=========================================####</span></span></span>
<span class="r-in"><span><span class="co"># ####=========================================####</span></span></span>
<span class="r-in"><span><span class="co"># data(DT_btdata)</span></span></span>
<span class="r-in"><span><span class="co"># DT &lt;- DT_btdata</span></span></span>
<span class="r-in"><span><span class="co"># mix3 &lt;- mmer(cbind(tarsus, back) ~ sex,</span></span></span>
<span class="r-in"><span><span class="co">#                random = ~ vsr(dam, Gtc=unsm(2)) + vsr(fosternest,Gtc=diag(2)),</span></span></span>
<span class="r-in"><span><span class="co">#                rcov=~vsr(units,Gtc=unsm(2)),</span></span></span>
<span class="r-in"><span><span class="co">#                data = DT)</span></span></span>
<span class="r-in"><span><span class="co"># summary(mix3)$varcomp</span></span></span>
<span class="r-in"><span><span class="co"># #### calculate the genetic correlation</span></span></span>
<span class="r-in"><span><span class="co"># vpredict(mix3, gen.cor ~ V2 / sqrt(V1*V3))</span></span></span>
<span class="r-in"><span><span class="co"># </span></span></span>
<span class="r-in"><span><span class="co"># ####=========================================####</span></span></span>
<span class="r-in"><span><span class="co"># ####=========================================####</span></span></span>
<span class="r-in"><span><span class="co"># #### EXAMPLE 4</span></span></span>
<span class="r-in"><span><span class="co"># #### going back to simple examples</span></span></span>
<span class="r-in"><span><span class="co"># ####=========================================####</span></span></span>
<span class="r-in"><span><span class="co"># ####=========================================####</span></span></span>
<span class="r-in"><span><span class="co"># data(DT_btdata)</span></span></span>
<span class="r-in"><span><span class="co"># DT &lt;- DT_btdata</span></span></span>
<span class="r-in"><span><span class="co"># mix4 &lt;- mmer(tarsus ~ sex, random = ~ dam + fosternest,</span></span></span>
<span class="r-in"><span><span class="co">#                data = DT) </span></span></span>
<span class="r-in"><span><span class="co"># summary(mix4)$varcomp</span></span></span>
<span class="r-in"><span><span class="co"># #### calculate the ratio and its SE</span></span></span>
<span class="r-in"><span><span class="co"># vpredict(mix4, dam.prop ~ V1 / ( V1 + V2 + V3 ) )</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/covaruber" class="external-link">Giovanny Covarrubias-Pazaran</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

