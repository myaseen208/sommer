<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>variance structure specification — vsr • sommer</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="variance structure specification — vsr"><meta name="description" content="vsr is the main function to build the variance-covariance structure for the random effects to be fitted in the mmer solver."><meta property="og:description" content="vsr is the main function to build the variance-covariance structure for the random effects to be fitted in the mmer solver."><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-116716530-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-116716530-2');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sommer</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">4.3.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-code"></span> Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-file-o"></span> Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/v1.sommer.quick.start.html">Quick Start</a></li>
    <li><a class="dropdown-item" href="../articles/v2.sommer.changes.and.faqs.html">FAQ</a></li>
    <li><a class="dropdown-item" href="../articles/v3.sommer.qg.html">Quantitative Genetics</a></li>
    <li><a class="dropdown-item" href="../articles/v4.sommer.gxe.html">GxE models</a></li>
    <li><a class="dropdown-item" href="../articles/v5.sommer.vs.lme4.html">sommer vs lme4</a></li>
    <li><a class="dropdown-item" href="../articles/v6.sommer.spatial.html">Spatial</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="https://github.com/covaruber/sommer" aria-label="GitHub repository"><span class="fa fa-github"></span> GitHub</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>variance structure specification</h1>

      <div class="d-none name"><code>vsr.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>vsr</code> is the main function to build the variance-covariance structure for the random effects to be fitted in the <code><a href="mmer.html">mmer</a></code> solver.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">vsr</span><span class="op">(</span><span class="va">...</span>, Gu<span class="op">=</span><span class="cn">NULL</span>, Gti<span class="op">=</span><span class="cn">NULL</span>, Gtc<span class="op">=</span><span class="cn">NULL</span>, reorderGu<span class="op">=</span><span class="cn">TRUE</span>, buildGu<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>variance structure to be specified following the logic desired in the internal kronecker product. For example, if user wants to define a diagonal variance structure for the random effect 'genotypes'(g) with respect to a random effect 'environments'(e), this is:</p>
<p><code>var(g) = G.e @ I.g</code></p>
<p>being <code>G.e</code>  a matrix containing the variance covariance components for g (genotypes) in each level of e (environments), <code>I.g</code> is the covariance among levels of g (genotypes; i.e. relationship matrix), and @ is the kronecker product. This would be specified in the mmer solver as:</p>
<p><code>random=~vsr(dsr(e),g)</code></p>
<p>One strength of sommer is the ability to specify very complex structures with as many kronecker products as desired. For example:</p>
<p><code>var(g) = G.e @ G.f @ G.h @ I.g</code></p>
<p>is equivalent to</p>
<p><code>random=~vsr(e,f,h,g)</code></p>
<p>where different covariance structures can be applied to the levels of <code>e,f,h</code> (i.e. <code><a href="dsr.html">dsr</a></code>, <code><a href="usr.html">usr</a></code>, <code><a href="csr.html">csr</a></code>, <code><a href="atr.html">atr</a></code> or a combination of these). For more examples please see the vignettes 'sommer.start' available in the package.</p></dd>


  <dt id="arg-gu">Gu<a class="anchor" aria-label="anchor" href="#arg-gu"></a></dt>
<dd><p>matrix with the known variance-covariance values for the levels of the u.th random effect (i.e. relationship matrix among individuals or any other known covariance matrix). If <code>NULL</code>, then an identity matrix is assumed. The Gu matrix can have more levels than the ones present in the random effect linked to it but not the other way around. Otherwise, an error message of missing level in Gu will be returned.</p></dd>


  <dt id="arg-gti">Gti<a class="anchor" aria-label="anchor" href="#arg-gti"></a></dt>
<dd><p>matrix with dimensions t x t (t equal to number of traits) with initial values of the variance-covariance components for the random effect specified in the .... argument. If <code>NULL</code> the program will provide the initial values. The values need to be scaled, see Details section.</p></dd>


  <dt id="arg-gtc">Gtc<a class="anchor" aria-label="anchor" href="#arg-gtc"></a></dt>
<dd><p>matrix with dimensions t x t (t equal to number of traits) of constraints for the variance-covariance components for the random effect specified in the ... argument according to the following rules:</p>
<p><code>0: not to be estimated</code></p>
<p><code>1: estimated and constrained to be positive (i.e. variance component)</code></p>
<p><code>2: estimated and unconstrained (can be negative or positive, i.e. covariance component)</code></p>
<p><code>3: not to be estimated but fixed (value has to be provided in the Gti argument)</code></p>
<p>In the multi-response scenario if the user doesn't specify this argument the default is to build an unstructured matrix (using the <code><a href="unsm.html">unsm</a></code>() function). This argument needs to be used wisely since some covariance among responses may not make sense. Useful functions to specify constraints are; <code><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></code>(), <code><a href="unsm.html">unsm</a></code>(), <code><a href="fixm.html">fixm</a></code>().</p></dd>


  <dt id="arg-reordergu">reorderGu<a class="anchor" aria-label="anchor" href="#arg-reordergu"></a></dt>
<dd><p>a <code>TRUE/FALSE</code> statement if the Gu matrix should be reordered based on the names of the design matrix of the random effect or passed with the custom order of the user. This may be important when fitting covariance components in a customized fashion. Only for advanced users.</p></dd>


    <dt id="arg-buildgu">buildGu<a class="anchor" aria-label="anchor" href="#arg-buildgu"></a></dt>
<dd><p>a <code>TRUE/FALSE</code> statement to indicate if the Gu matrix should be built in R when the value for the argument <code>Gu=NULL</code>. Repeat, only when when the value for the argument <code>Gu</code> is equal to <code>NULL</code>. In some cases when the incidence matrix is wide (e.g. rrBLUP models) the covariance structure is a huge p x p matrix that can be avoided when performing matrix operations. By setting this argument to <code>FALSE</code> it allows to skip forming this covariance matrix.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>When providing initial values in the <code>Gti</code> argument the user has to provide scaled variance component values. The user can provide values from a previous model by accessing the <code>sigma_scaled</code> output from an <code>mmer</code> model or if an specific value is desired the user can obtain the scaled value as:</p>
<p><code>m = x/var(y)</code></p>
<p>where <code>x</code> is the desired initial value and <code>y</code> is the response variable. You can find an example in the <code><a href="DT_cpdata.html">DT_cpdata</a></code> dataset.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p></p><dl><dt>$res</dt>
<dd><p>a list with all neccesary elements (incidence matrices, known var-cov structures, unknown covariance structures to be estimated and constraints) to be used in the mmer solver.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Covarrubias-Pazaran G (2016) Genome assisted prediction of quantitative traits using the R package sommer. PLoS ONE 11(6): doi:10.1371/journal.pone.0156744</p>
<p>Covarrubias-Pazaran G (2018) Software update: Moving the R package sommer to
  multivariate mixed models for genome-assisted prediction. doi:
  https://doi.org/10.1101/354639</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Giovanny Covarrubias-Pazaran</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>The core function of the package: <code><a href="mmer.html">mmer</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">DT_example</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT_example</span></span></span>
<span class="r-in"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="va">A_example</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ============================ ##</span></span></span>
<span class="r-in"><span><span class="co">## example to without structure</span></span></span>
<span class="r-in"><span><span class="co">## ============================ ##</span></span></span>
<span class="r-in"><span><span class="fu"><a href="dsr.html">dsr</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">Year</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2011 2012 2013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53     1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 76     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 77     1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 78     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 79     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 80     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 81     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 82     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 83     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 84     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 85     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 86     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 87     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 88     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 89     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 91     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 92     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 93     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 94     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 96     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 97     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 98     1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 99     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 101    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 102    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 103    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 104    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 105    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 106    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 107    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 108    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 109    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 110    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 111    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 112    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 113    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 114    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 115    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 116    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 117    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 118    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 119    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 120    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 121    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 122    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 123    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 124    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 125    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 126    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 127    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 128    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 129    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 130    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 131    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 132    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 133    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 134    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 135    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 136    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 137    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 138    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 139    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 140    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 141    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 142    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 143    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 144    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 145    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 146    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 147    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 148    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 149    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 150    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 151    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 152    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 153    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 154    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 155    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 156    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 157    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 158    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 159    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 160    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 161    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 162    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 163    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 164    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 165    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 166    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 167    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 168    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 170    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 171    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 172    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 173    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 174    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 175    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 176    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 177    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 178    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 179    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 180    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 181    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 182    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 183    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 184    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 185    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"assign")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"contrasts")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"contrasts")$dummy</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "contr.treatment"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $thetaC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      2011 2012 2013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2011    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2012    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2013    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">mix</span> <span class="op">&lt;-</span> <span class="fu"><a href="mmer.html">mmer</a></span><span class="op">(</span><span class="va">Yield</span><span class="op">~</span><span class="va">Env</span>, </span></span>
<span class="r-in"><span>            random<span class="op">=</span> <span class="op">~</span> <span class="fu">vsr</span><span class="op">(</span><span class="va">Name</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            rcov<span class="op">=</span><span class="op">~</span> <span class="fu">vsr</span><span class="op">(</span><span class="va">units</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            data<span class="op">=</span><span class="va">DT</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iteration    LogLik     wall    cpu(sec)   restrained</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1      -36.8096   1:17:27      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2      -33.211   1:17:27      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3      -32.6234   1:17:27      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     4      -32.5942   1:17:27      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     5      -32.5942   1:17:27      0           0</span>
<span class="r-in"><span>            </span></span>
<span class="r-in"><span><span class="co">## ============================ ##</span></span></span>
<span class="r-in"><span><span class="co">## example to without structure but </span></span></span>
<span class="r-in"><span><span class="co">## using covariance among levels in the</span></span></span>
<span class="r-in"><span><span class="co">## random effect Name</span></span></span>
<span class="r-in"><span><span class="co">## ============================ ##</span></span></span>
<span class="r-in"><span><span class="fu"><a href="dsr.html">dsr</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">Year</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2011 2012 2013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53     1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 76     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 77     1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 78     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 79     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 80     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 81     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 82     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 83     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 84     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 85     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 86     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 87     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 88     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 89     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 91     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 92     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 93     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 94     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 96     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 97     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 98     1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 99     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 101    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 102    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 103    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 104    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 105    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 106    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 107    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 108    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 109    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 110    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 111    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 112    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 113    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 114    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 115    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 116    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 117    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 118    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 119    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 120    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 121    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 122    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 123    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 124    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 125    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 126    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 127    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 128    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 129    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 130    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 131    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 132    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 133    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 134    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 135    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 136    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 137    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 138    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 139    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 140    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 141    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 142    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 143    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 144    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 145    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 146    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 147    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 148    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 149    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 150    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 151    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 152    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 153    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 154    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 155    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 156    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 157    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 158    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 159    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 160    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 161    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 162    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 163    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 164    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 165    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 166    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 167    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 168    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 170    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 171    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 172    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 173    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 174    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 175    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 176    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 177    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 178    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 179    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 180    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 181    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 182    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 183    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 184    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 185    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"assign")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"contrasts")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"contrasts")$dummy</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "contr.treatment"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $thetaC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      2011 2012 2013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2011    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2012    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2013    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">mix</span> <span class="op">&lt;-</span> <span class="fu"><a href="mmer.html">mmer</a></span><span class="op">(</span><span class="va">Yield</span><span class="op">~</span><span class="va">Env</span>, </span></span>
<span class="r-in"><span>            random<span class="op">=</span> <span class="op">~</span> <span class="fu">vsr</span><span class="op">(</span><span class="va">Name</span>, Gu<span class="op">=</span><span class="va">A</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            rcov<span class="op">=</span><span class="op">~</span> <span class="fu">vsr</span><span class="op">(</span><span class="va">units</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            data<span class="op">=</span><span class="va">DT</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iteration    LogLik     wall    cpu(sec)   restrained</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1      -36.8096   1:17:27      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2      -33.211   1:17:27      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3      -32.6234   1:17:27      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     4      -32.5942   1:17:27      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     5      -32.5942   1:17:27      0           0</span>
<span class="r-in"><span>            </span></span>
<span class="r-in"><span><span class="co">## ============================ ##</span></span></span>
<span class="r-in"><span><span class="co">## example to use dsr() structure (DIAGONAL)</span></span></span>
<span class="r-in"><span><span class="co">## ============================ ##</span></span></span>
<span class="r-in"><span><span class="fu"><a href="dsr.html">dsr</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">Year</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2011 2012 2013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53     1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 76     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 77     1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 78     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 79     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 80     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 81     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 82     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 83     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 84     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 85     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 86     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 87     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 88     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 89     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 91     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 92     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 93     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 94     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 96     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 97     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 98     1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 99     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 101    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 102    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 103    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 104    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 105    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 106    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 107    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 108    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 109    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 110    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 111    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 112    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 113    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 114    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 115    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 116    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 117    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 118    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 119    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 120    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 121    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 122    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 123    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 124    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 125    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 126    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 127    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 128    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 129    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 130    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 131    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 132    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 133    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 134    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 135    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 136    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 137    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 138    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 139    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 140    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 141    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 142    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 143    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 144    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 145    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 146    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 147    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 148    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 149    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 150    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 151    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 152    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 153    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 154    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 155    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 156    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 157    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 158    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 159    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 160    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 161    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 162    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 163    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 164    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 165    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 166    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 167    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 168    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 170    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 171    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 172    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 173    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 174    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 175    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 176    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 177    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 178    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 179    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 180    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 181    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 182    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 183    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 184    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 185    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"assign")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"contrasts")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"contrasts")$dummy</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "contr.treatment"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $thetaC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      2011 2012 2013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2011    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2012    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2013    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">mix</span> <span class="op">&lt;-</span> <span class="fu"><a href="mmer.html">mmer</a></span><span class="op">(</span><span class="va">Yield</span><span class="op">~</span><span class="va">Env</span>, </span></span>
<span class="r-in"><span>            random<span class="op">=</span> <span class="op">~</span> <span class="fu">vsr</span><span class="op">(</span><span class="fu"><a href="dsr.html">dsr</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span>,<span class="va">Name</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            rcov<span class="op">=</span><span class="op">~</span> <span class="fu">vsr</span><span class="op">(</span><span class="fu"><a href="dsr.html">dsr</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span>,<span class="va">units</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            data<span class="op">=</span><span class="va">DT</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iteration    LogLik     wall    cpu(sec)   restrained</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1      -42.26   1:17:27      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2      -25.3744   1:17:27      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3      -19.1877   1:17:27      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     4      -18.3538   1:17:27      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     5      -18.3432   1:17:27      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     6      -18.343   1:17:27      0           0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ============================ ##</span></span></span>
<span class="r-in"><span><span class="co">## example to use atr() structure (level-specific)</span></span></span>
<span class="r-in"><span><span class="co">## ============================ ##</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">Year</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2013 2011 2012</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Levels: 2011 2012 2013</span>
<span class="r-in"><span><span class="va">mix</span> <span class="op">&lt;-</span> <span class="fu"><a href="mmer.html">mmer</a></span><span class="op">(</span><span class="va">Yield</span><span class="op">~</span><span class="va">Env</span>, </span></span>
<span class="r-in"><span>            random<span class="op">=</span> <span class="op">~</span> <span class="fu">vsr</span><span class="op">(</span><span class="fu"><a href="atr.html">atr</a></span><span class="op">(</span><span class="va">Year</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2011"</span>,<span class="st">"2012"</span><span class="op">)</span><span class="op">)</span>,<span class="va">Name</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            rcov<span class="op">=</span><span class="op">~</span> <span class="fu">vsr</span><span class="op">(</span><span class="fu"><a href="dsr.html">dsr</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span>,<span class="va">units</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            data<span class="op">=</span><span class="va">DT</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iteration    LogLik     wall    cpu(sec)   restrained</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1      -45.5289   1:17:27      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2      -35.9052   1:17:27      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3      -33.3779   1:17:27      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     4      -33.0963   1:17:27      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     5      -33.0911   1:17:27      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     6      -33.091   1:17:27      0           0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ============================ ##</span></span></span>
<span class="r-in"><span><span class="co">## example to use usr() structure (UNSTRUCTURED)</span></span></span>
<span class="r-in"><span><span class="co">## ============================ ##</span></span></span>
<span class="r-in"><span><span class="fu"><a href="usr.html">usr</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">Year</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2011 2012 2013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53     1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 76     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 77     1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 78     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 79     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 80     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 81     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 82     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 83     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 84     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 85     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 86     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 87     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 88     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 89     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 91     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 92     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 93     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 94     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 96     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 97     0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 98     1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 99     0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 101    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 102    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 103    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 104    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 105    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 106    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 107    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 108    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 109    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 110    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 111    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 112    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 113    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 114    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 115    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 116    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 117    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 118    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 119    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 120    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 121    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 122    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 123    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 124    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 125    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 126    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 127    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 128    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 129    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 130    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 131    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 132    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 133    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 134    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 135    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 136    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 137    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 138    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 139    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 140    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 141    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 142    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 143    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 144    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 145    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 146    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 147    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 148    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 149    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 150    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 151    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 152    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 153    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 154    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 155    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 156    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 157    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 158    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 159    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 160    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 161    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 162    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 163    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 164    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 165    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 166    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 167    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 168    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 170    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 171    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 172    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 173    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 174    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 175    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 176    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 177    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 178    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 179    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 180    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 181    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 182    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 183    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 184    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 185    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"assign")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"contrasts")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"contrasts")$dummy</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "contr.treatment"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $thetaC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      2011 2012 2013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2011    1    2    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2012    2    1    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2013    2    2    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">mix</span> <span class="op">&lt;-</span> <span class="fu"><a href="mmer.html">mmer</a></span><span class="op">(</span><span class="va">Yield</span><span class="op">~</span><span class="va">Env</span>, </span></span>
<span class="r-in"><span>            random<span class="op">=</span> <span class="op">~</span> <span class="fu">vsr</span><span class="op">(</span><span class="fu"><a href="usr.html">usr</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span>,<span class="va">Name</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            rcov<span class="op">=</span><span class="op">~</span> <span class="fu">vsr</span><span class="op">(</span><span class="fu"><a href="dsr.html">dsr</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span>,<span class="va">units</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            data<span class="op">=</span><span class="va">DT</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iteration    LogLik     wall    cpu(sec)   restrained</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1      -37.9059   1:17:28      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2      -17.9745   1:17:28      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3      -12.2427   1:17:28      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     4      -11.5121   1:17:28      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     5      -11.5001   1:17:28      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     6      -11.4997   1:17:28      0           0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ============================ ##</span></span></span>
<span class="r-in"><span><span class="co">## example to use csr() structure (CUSTOMIZED)</span></span></span>
<span class="r-in"><span><span class="co">## ============================ ##</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">Year</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2013 2011 2012</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Levels: 2011 2012 2013</span>
<span class="r-in"><span><span class="va">mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>; <span class="va">mm</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">mm</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span>;<span class="va">mm</span> <span class="co">#don't estimate cov 2011-2013</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    1    1    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    0    1    1</span>
<span class="r-in"><span><span class="va">mix</span> <span class="op">&lt;-</span> <span class="fu"><a href="mmer.html">mmer</a></span><span class="op">(</span><span class="va">Yield</span><span class="op">~</span><span class="va">Env</span>, </span></span>
<span class="r-in"><span>            random<span class="op">=</span> <span class="op">~</span> <span class="fu">vsr</span><span class="op">(</span><span class="fu"><a href="csr.html">csr</a></span><span class="op">(</span><span class="va">Year</span>,<span class="va">mm</span><span class="op">)</span>,<span class="va">Name</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            rcov<span class="op">=</span><span class="op">~</span> <span class="fu">vsr</span><span class="op">(</span><span class="fu"><a href="dsr.html">dsr</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span>,<span class="va">units</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            data<span class="op">=</span><span class="va">DT</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iteration    LogLik     wall    cpu(sec)   restrained</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1      -40.2254   1:17:28      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2      -22.056   1:17:28      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3      -15.6387   1:17:28      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     4      -14.6846   1:17:28      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     5      -14.6138   1:17:28      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     6      -14.594   1:17:28      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     7      -14.5877   1:17:29      1           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     8      -14.5857   1:17:29      1           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     9      -14.5851   1:17:29      1           0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ============================ ##</span></span></span>
<span class="r-in"><span><span class="co">## example to use overlay() + vsr() structure</span></span></span>
<span class="r-in"><span><span class="co">## ============================ ##</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"DT_halfdiallel"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="va">DT_halfdiallel</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   rep geno male female     sugar</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   1   12    1      2 13.950509</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   2   12    1      2  9.756918</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   1   13    1      3 13.906355</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   2   13    1      3  9.119455</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   1   14    1      4  5.174483</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   2   14    1      4  8.452221</span>
<span class="r-in"><span><span class="va">DT</span><span class="op">$</span><span class="va">femalef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">female</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">DT</span><span class="op">$</span><span class="va">malef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">male</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">DT</span><span class="op">$</span><span class="va">genof</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">DT</span><span class="op">$</span><span class="va">geno</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">7</span>;<span class="va">A</span> <span class="co"># if you want to provide a covariance matrix</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1 2 3 4 5 6 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1 0 0 0 0 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0 1 0 0 0 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0 0 1 0 0 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0 0 0 1 0 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0 0 0 0 1 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 0 0 0 0 0 1 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7 0 0 0 0 0 0 1</span>
<span class="r-in"><span><span class="co">#### model using overlay</span></span></span>
<span class="r-in"><span><span class="va">modh</span> <span class="op">&lt;-</span> <span class="fu"><a href="mmer.html">mmer</a></span><span class="op">(</span><span class="va">sugar</span><span class="op">~</span><span class="fl">1</span>, </span></span>
<span class="r-in"><span>             random<span class="op">=</span><span class="op">~</span><span class="fu">vsr</span><span class="op">(</span><span class="fu"><a href="overlay.html">overlay</a></span><span class="op">(</span><span class="va">femalef</span>,<span class="va">malef</span>,sparse<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>, Gu<span class="op">=</span><span class="va">A</span><span class="op">)</span> </span></span>
<span class="r-in"><span>                     <span class="op">+</span> <span class="va">genof</span>,</span></span>
<span class="r-in"><span>              data<span class="op">=</span><span class="va">DT</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iteration    LogLik     wall    cpu(sec)   restrained</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1      -10.425   1:17:29      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2      -6.487   1:17:29      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3      -5.732   1:17:29      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     4      -5.67494   1:17:29      0           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     5      -5.67441   1:17:29      0           0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ============================ ##</span></span></span>
<span class="r-in"><span><span class="co">## example to use vsr() + dsr() + spl2D() structure</span></span></span>
<span class="r-in"><span><span class="co">## ============================ ##            </span></span></span>
<span class="r-in"><span><span class="co"># ### mimic two fields</span></span></span>
<span class="r-in"><span><span class="co"># data(DT_cpdata)</span></span></span>
<span class="r-in"><span><span class="co"># DT &lt;- DT_cpdata</span></span></span>
<span class="r-in"><span><span class="co"># GT &lt;- GT_cpdata</span></span></span>
<span class="r-in"><span><span class="co"># MP &lt;- MP_cpdata</span></span></span>
<span class="r-in"><span><span class="co"># aa &lt;- DT; bb &lt;- DT</span></span></span>
<span class="r-in"><span><span class="co"># aa$FIELD &lt;- "A";bb$FIELD &lt;- "B"</span></span></span>
<span class="r-in"><span><span class="co"># set.seed(1234)</span></span></span>
<span class="r-in"><span><span class="co"># aa$Yield &lt;- aa$Yield + rnorm(length(aa$Yield),0,4)</span></span></span>
<span class="r-in"><span><span class="co"># DT2 &lt;- rbind(aa,bb)</span></span></span>
<span class="r-in"><span><span class="co"># head(DT2)</span></span></span>
<span class="r-in"><span><span class="co"># </span></span></span>
<span class="r-in"><span><span class="co"># mix &lt;- mmer(Yield~1,</span></span></span>
<span class="r-in"><span><span class="co">#             random=~vsr(dsr(FIELD),id, Gu=A) + </span></span></span>
<span class="r-in"><span><span class="co">#               vsr(dsr(FIELD),Rowf) +</span></span></span>
<span class="r-in"><span><span class="co">#               vsr(dsr(FIELD),Colf) +</span></span></span>
<span class="r-in"><span><span class="co">#                 vsr(dsr(FIELD),spl2D(Row,Col)),</span></span></span>
<span class="r-in"><span><span class="co">#             rcov=~vsr(dsr(FIELD),units),</span></span></span>
<span class="r-in"><span><span class="co">#             data=DT2)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/covaruber" class="external-link">Giovanny Covarrubias-Pazaran</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

